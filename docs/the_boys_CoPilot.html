<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Boys Shows</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #eee;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #f0c000;
    }
    details {
      margin-bottom: 10px;
      border: 1px solid #444;
      padding: 10px;
      background-color: #222;
    }
    summary {
      cursor: pointer;
      font-weight: bold;
      color: #f0c000;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 0.9em;
    }
    th, td {
      border: 1px solid #555;
      padding: 6px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background-color: #333;
      color: #f0c000;
      cursor: pointer;
    }
    /* Zebra striping + hover */
    table tr:nth-child(even) { background-color: #1a1a1a; }
    table tr:nth-child(odd) { background-color: #111; }
    table tr:hover { background-color: #333; }
    /* Watch status badges */
    .status-watched { color: #0f0; font-weight: bold; }
    .status-watching { color: #0ff; font-weight: bold; }
    .status-none { color: #f66; font-weight: bold; }
  </style>
</head>
<body>

<h1>The Boys Shows</h1>

<details open>
  <summary>+/- Shows</summary>
  <div id="shows"></div>
</details>

<details open>
  <summary>+/- Movies</summary>
  <div id="movies"></div>
</details>

<script>
const dataUrl = 'https://raw.githubusercontent.com/AJPnKW/IPTV_Data_Harmonization_System/main/docs/show_and_movie_data.tile.txt';

function badge(status) {
  if (!status) return '';
  const s = status.toLowerCase();
  if (s.includes('watched')) return `<span class="status-watched">✅ ${status}</span>`;
  if (s.includes('watching')) return `<span class="status-watching">⏳ ${status}</span>`;
  return `<span class="status-none">❌ ${status}</span>`;
}

async function loadData() {
  const res = await fetch(dataUrl);
  const text = await res.text();
  const lines = text.split('\n').map(l => l.trim()).filter(l => l && !l.startsWith('#'));

  const shows = {};
  const movies = [];
  let currentShow = null;
  let currentSeason = null;

  for (const line of lines) {
    const parts = line.split('|').map(p => p.trim());
    const type = parts[0];

    if (type === 'show') {
      const [_, id, name, overview, date, status, source, schedule, url] = parts;
      currentShow = { id, name, overview, date, status, source, schedule, url, seasons: [] };
      shows[id] = currentShow;
    }

    if (type === 'season' && currentShow) {
      const [_, showId, seasonNum, year, overview, watchStatus] = parts;
      currentSeason = { seasonNum, year, overview, watchStatus, episodes: [] };
      shows[showId].seasons.push(currentSeason);
    }

    if (type === 'episode' && currentSeason) {
      const [_, showId, epNum, title, date, desc, runtime, source, vidSrc, mapple, nunFlix, tbd, watchStatus] = parts;
      currentSeason.episodes.push({ epNum, title, date, desc, runtime, source, vidSrc, mapple, nunFlix, tbd, watchStatus });
    }

    if (type === 'movie') {
      const [_, id, name, overview, releaseDate, rating, runtime, source, vidSrc, mapple, nunFlix, tbd, watchStatus] = parts;
      movies.push({ id, name, overview, releaseDate, rating, runtime, source, vidSrc, mapple, nunFlix, tbd, watchStatus });
    }
  }

  renderShows(shows);
  renderMovies(movies);
}

function renderShows(shows) {
  const container = document.getElementById('shows');
  Object.values(shows).forEach(show => {
    const showDetails = document.createElement('details');
    showDetails.open = true;
    const showSummary = document.createElement('summary');
    showSummary.textContent = show.name;
    showDetails.appendChild(showSummary);

    const table = document.createElement('table');
    const header = document.createElement('tr');
    ['TMDB ID','Name','Overview','Date','Status','Source','Schedule','URL'].forEach(h => {
      const th = document.createElement('th'); th.textContent = h; header.appendChild(th);
    });
    table.appendChild(header);

    const row = document.createElement('tr');
    [show.id, show.name, show.overview, show.date, show.status, show.source, show.schedule, show.url].forEach((val,i) => {
      const td = document.createElement('td');
      if (i===7 && val) { td.innerHTML = `<a href="${val}" target="_blank">${val}</a>`; }
      else td.textContent = val;
      row.appendChild(td);
    });
    table.appendChild(row);
    showDetails.appendChild(table);

    show.seasons.forEach(season => {
      const seasonDetails = document.createElement('details');
      seasonDetails.open = true;
      const seasonSummary = document.createElement('summary');
      seasonSummary.textContent = `Season ${season.seasonNum} (${season.year}) • ${season.episodes.length} Episodes`;
      seasonDetails.appendChild(seasonSummary);

      const seasonTable = document.createElement('table');
      const sHeader = document.createElement('tr');
      ['Season #','Year','Overview','Watch Status'].forEach(h => {
        const th = document.createElement('th'); th.textContent = h; sHeader.appendChild(th);
      });
      seasonTable.appendChild(sHeader);
      const sRow = document.createElement('tr');
      [season.seasonNum, season.year, season.overview, badge(season.watchStatus)].forEach(val => {
        const td = document.createElement('td'); td.innerHTML = val; sRow.appendChild(td);
      });
      seasonTable.appendChild(sRow);
      seasonDetails.appendChild(seasonTable);

      if (season.episodes.length > 0) {
        const epTable = document.createElement('table');
        const eHeader = document.createElement('tr');
        ['#','Title','Date','Description','Runtime','Source','vidSrc','mapple','nunFlix','tbd','Watch Status'].forEach(h => {
          const th = document.createElement('th'); th.textContent = h; eHeader.appendChild(th);
        });
        epTable.appendChild(eHeader);

        season.episodes.forEach(ep => {
          const row = document.createElement('tr');
          [ep.epNum, ep.title, ep.date, ep.desc, ep.runtime, ep.source, ep.vidSrc, ep.mapple, ep.nunFlix, ep.tbd, badge(ep.watchStatus)].forEach(val => {
            const td = document.createElement('td'); td.innerHTML = val; row.appendChild(td);
          });
          epTable.appendChild(row);
        });
        seasonDetails.appendChild(epTable);
      }

      showDetails.appendChild(seasonDetails);
    });

    container.appendChild(showDetails);
  });
}

function renderMovies(movies) {
  const container = document.getElementById('movies');
  const table = document.createElement('table');
  const header = document.createElement('tr');
  ['TMDB ID','Name','Overview','Release Date','Rating','Runtime','Source','vidSrc','mapple','nunFlix','tbd','Watch Status'].forEach(h => {
    const th = document.createElement('th'); th.textContent = h; header.appendChild(th);
  });
  table.appendChild(header);

  movies.forEach(movie => {
    const row = document.createElement('tr');
    [movie.id, movie.name, movie.overview, movie.releaseDate, movie.rating, movie.runtime, movie.source, movie.vidSrc, movie.mapple, movie.nunFlix, movie.tbd, movie.watchStatus].forEach(val => {
      const td = document.createElement('td'); td.textContent = val; row.appendChild(td);
    });
    table.appendChild(row);
  });

  container.appendChild(table);
}

loadData();
</script>

</body>
</html>
