<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Boys Shows</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #eee;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #f0c000;
    }
    details {
      margin-bottom: 10px;
      border: 1px solid #444;
      padding: 10px;
      background-color: #222;
    }
    summary {
      cursor: pointer;
      font-weight: bold;
      color: #f0c000;
    }
    .season, .episode, .movie {
      margin-left: 20px;
      margin-top: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #555;
      padding: 6px;
      text-align: left;
    }
    th {
      background-color: #333;
    }
  </style>
</head>
<body>

<h1>The Boys Shows</h1>

<details open>
  <summary>+/- Shows</summary>
  <div id="shows"></div>
</details>

<details open>
  <summary>+/- Movies</summary>
  <div id="movies"></div>
</details>

<script>
const dataUrl = 'https://raw.githubusercontent.com/AJPnKW/IPTV_Data_Harmonization_System/main/docs/show%2Bmovie_data.tile.txt';

async function loadData() {
  const res = await fetch(dataUrl);
  const text = await res.text();
  const lines = text.split('\\n').filter(line => line.trim() && !line.trim().startsWith('#'));

  const shows = {};
  const movies = [];

  let currentShow = null;
  let currentSeason = null;

  for (const line of lines) {
    const parts = line.split('|');
    const type = parts[0];

    if (type === 'show') {
      const [_, id, name, overview] = parts;
      currentShow = { id, name, overview, seasons: [] };
      shows[id] = currentShow;
    }

    if (type === 'season' && currentShow) {
      const [_, showId, seasonNum, year, overview] = parts;
      currentSeason = { seasonNum, year, overview, episodes: [] };
      shows[showId].seasons.push(currentSeason);
    }

    if (type === 'episode' && currentSeason) {
      const [_, showId, epNum, name, date, desc, runtime] = parts;
      currentSeason.episodes.push({ epNum, name, date, desc, runtime });
    }

    if (type === 'movie') {
      const [_, id, name, overview, releaseDate, rating, runtime] = parts;
      movies.push({ id, name, overview, releaseDate, rating, runtime });
    }
  }

  renderShows(shows);
  renderMovies(movies);
}

function renderShows(shows) {
  const container = document.getElementById('shows');
  Object.values(shows).forEach(show => {
    const showDetails = document.createElement('details');
    showDetails.open = true;
    const showSummary = document.createElement('summary');
    showSummary.textContent = `${show.name}`;
    showDetails.appendChild(showSummary);

    const showDesc = document.createElement('div');
    showDesc.className = 'season';
    showDesc.textContent = show.overview;
    showDetails.appendChild(showDesc);

    show.seasons.forEach(season => {
      const seasonDetails = document.createElement('details');
      seasonDetails.open = true;
      const seasonSummary = document.createElement('summary');
      seasonSummary.textContent = `Season ${season.seasonNum} (${season.year}) â€¢ ${season.episodes.length} Episodes`;
      seasonDetails.appendChild(seasonSummary);

      const table = document.createElement('table');
      const header = document.createElement('tr');
      ['#', 'Title', 'Date', 'Length', 'Description'].forEach(h => {
        const th = document.createElement('th');
        th.textContent = h;
        header.appendChild(th);
      });
      table.appendChild(header);

      season.episodes.forEach(ep => {
        const row = document.createElement('tr');
        [ep.epNum, ep.name, ep.date, ep.runtime, ep.desc].forEach(val => {
          const td = document.createElement('td');
          td.textContent = val;
          row.appendChild(td);
        });
        table.appendChild(row);
      });

      seasonDetails.appendChild(table);
      showDetails.appendChild(seasonDetails);
    });

    container.appendChild(showDetails);
  });
}

function renderMovies(movies) {
  const container = document.getElementById('movies');
  movies.forEach(movie => {
    const div = document.createElement('div');
    div.className = 'movie';
    div.innerHTML = `<strong>${movie.name}</strong><br>
      Release Date: ${movie.releaseDate}<br>
      Runtime: ${movie.runtime}<br>
      Overview: ${movie.overview}`;
    container.appendChild(div);
  });
}

loadData();
</script>

<!--
  HOW TO EDIT:
  - Edit the file "show+movie_data.tile.txt" in the /docs folder of your GitHub repo.
  - Each line represents a show, season, episode, or movie.
  - Lines starting with "#" are ignored.
  - Save and refresh this HTML page to see updates.
-->
</body>
</html>
